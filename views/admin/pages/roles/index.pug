extend ../../layouts/default.pug
include ../../mixins/alert.pug

block main
    if(role.permissions.includes("roles_view"))
        +alert-success(5000)

        // Header
        .d-flex.justify-content-between.align-items-center.mb-4
            h2.fw-bold.text-dark.mb-0 Quản lý nhóm quyền
            if(role.permissions.includes("roles_create"))
                a.btn.btn-primary.px-4(href=`${prefixAdmin}/roles/create`)
                    i.fas.fa-plus.me-2
                    | Thêm mới
                
        // Roles Table
        .bg-white.rounded-3.shadow-sm.overflow-hidden
            .table-responsive
                table.table.table-hover.mb-0.admin-table
                    thead
                        tr
                            th.py-4.border-0.text-center.fw-bold.text-muted(width="70" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);")
                                i.fas.fa-hashtag.me-1
                                | STT
                            th.py-4.border-0.fw-bold.text-muted(width="200" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);")
                                i.fas.fa-user-shield.me-1
                                | Tên nhóm quyền
                            th.py-4.border-0.fw-bold.text-muted(width="300" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);")
                                i.fas.fa-info-circle.me-1
                                | Mô tả quyền
                            th.py-4.border-0.text-center.fw-bold.text-muted(width="180" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);")
                                i.fas.fa-cogs.me-1
                                | Thao tác

                    tbody
                        if(records.length > 0)
                            each item, index in records
                                tr.table-row-hover.align-middle
                                    td.text-center.fw-bold.text-muted
                                        | #{index + 1}
                                    
                                    td.align-middle
                                        .d-flex.align-items-center
                                            .role-icon.me-3
                                                .bg-primary.bg-opacity-10.rounded-circle.d-flex.align-items-center.justify-content-center(style="width: 40px; height: 40px;")
                                                    i.fas.fa-user-shield.text-primary
                                            .role-info
                                                .fw-semibold.text-dark #{item.title}
                                                .small.text-muted.mt-1 ID: #{item.id}
                                    
                                    td.align-middle
                                        .text-dark #{item.description}
                                        .small.text-muted.mt-1
                                            i.fas.fa-info-circle.me-1
                                            | Mô tả chi tiết quyền hạn
                                    
                                    td.text-center.align-middle
                                        .btn-group.btn-group-sm(role="group")
                                            a.btn.btn-outline-info.btn-sm.rounded-pill.me-1(
                                                href=`${prefixAdmin}/roles/detail/${item.id}`
                                                title="Xem chi tiết"
                                            )
                                                i.fas.fa-eye
                                            
                                            if(role.permissions.includes("roles_edit"))
                                                a.btn.btn-outline-warning.btn-sm.rounded-pill.me-1(
                                                    href=`${prefixAdmin}/roles/edit/${item.id}`
                                                    title="Chỉnh sửa"
                                                )
                                                    i.fas.fa-edit
                                            
                                            if(role.permissions.includes("roles_delete"))
                                                button.btn.btn-outline-danger.btn-sm.rounded-pill(
                                                    button-delete
                                                    data-id=item.id
                                                    title="Xóa nhóm quyền"
                                                )
                                                    i.fas.fa-trash-alt
                        else
                            tr
                                td.text-center.py-5(colspan="4")
                                    .text-muted
                                        i.fas.fa-user-shield.fa-3x.mb-3.d-block.opacity-25
                                        h5 Chưa có nhóm quyền nào
                                        p.mb-3 Hãy tạo nhóm quyền đầu tiên để phân quyền
                                        if(role.permissions.includes("roles_create"))
                                            a.btn.btn-primary(href=`${prefixAdmin}/roles/create`)
                                                i.fas.fa-plus.me-2
                                                | Tạo nhóm quyền mới

    // Hidden Forms
    form#form-delete-item(
        action=""
        method="POST"
        data-path=`${prefixAdmin}/roles/delete`
    )

    script(src="/admin/js/product.js") 
